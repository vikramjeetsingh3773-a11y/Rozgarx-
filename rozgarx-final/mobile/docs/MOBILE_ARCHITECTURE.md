# RozgarX AI — Mobile App Architecture Guide
# Flutter | Android-First | Offline-Capable | Low-End Optimized
# ============================================================


## COMPLETE FOLDER STRUCTURE

rozgarx-ai/mobile/
├── pubspec.yaml                    # Dependencies
│
├── android/
│   └── app/
│       ├── build.gradle            # Min SDK 26, target SDK 34
│       └── src/main/
│           ├── AndroidManifest.xml # Permissions, FCM config
│           └── res/                # App icons, splash
│
├── lib/
│   │
│   ├── main.dart                   # App entry point, Firebase init
│   │
│   ├── core/
│   │   ├── firebase/
│   │   │   ├── firebase_options.dart      # Auto-generated by FlutterFire CLI
│   │   │   └── firestore_service.dart     # Firestore instance + offline persistence
│   │   │
│   │   ├── cache/
│   │   │   └── cache_service.dart         # ✅ GENERATED — Hive offline cache
│   │   │
│   │   ├── network/
│   │   │   └── network_service.dart       # ✅ GENERATED — Bandwidth detection
│   │   │
│   │   ├── theme/
│   │   │   └── app_theme.dart             # ✅ GENERATED — Dark/Light theme
│   │   │
│   │   └── router/
│   │       └── app_router.dart            # go_router navigation
│   │
│   ├── features/
│   │   │
│   │   ├── auth/
│   │   │   ├── screens/
│   │   │   │   ├── splash_screen.dart
│   │   │   │   ├── login_screen.dart
│   │   │   │   └── onboarding_screen.dart
│   │   │   └── repository/
│   │   │       └── auth_repository.dart
│   │   │
│   │   ├── jobs/
│   │   │   ├── screens/
│   │   │   │   ├── jobs_list_screen.dart
│   │   │   │   ├── job_detail_screen.dart
│   │   │   │   └── pdf_viewer_screen.dart  # ✅ GENERATED
│   │   │   ├── widgets/
│   │   │   │   ├── job_card.dart           # ✅ GENERATED — adaptive card
│   │   │   │   ├── job_filter_sheet.dart
│   │   │   │   └── search_bar_widget.dart
│   │   │   └── repository/
│   │   │       └── job_repository.dart     # ✅ GENERATED — offline-first
│   │   │
│   │   ├── dashboard/
│   │   │   ├── screens/
│   │   │   │   └── dashboard_screen.dart
│   │   │   └── widgets/
│   │   │       ├── deadline_widget.dart
│   │   │       ├── readiness_score_widget.dart
│   │   │       └── study_streak_widget.dart
│   │   │
│   │   ├── preparation/
│   │   │   ├── screens/
│   │   │   │   ├── study_plan_screen.dart
│   │   │   │   └── progress_screen.dart
│   │   │   └── widgets/
│   │   │       └── plan_day_card.dart
│   │   │
│   │   ├── mock_tests/
│   │   │   ├── screens/
│   │   │   │   ├── test_list_screen.dart
│   │   │   │   ├── test_screen.dart
│   │   │   │   └── result_screen.dart
│   │   │   └── widgets/
│   │   │       └── question_widget.dart
│   │   │
│   │   └── premium/
│   │       ├── screens/
│   │       │   └── premium_screen.dart
│   │       └── services/
│   │           └── razorpay_service.dart
│   │
│   └── shared/
│       ├── models/
│       │   ├── job_model.dart              # ✅ GENERATED — full Firestore model
│       │   ├── user_model.dart
│       │   └── study_plan_model.dart
│       ├── widgets/
│       │   ├── offline_banner.dart
│       │   ├── shimmer_list.dart
│       │   └── premium_lock_widget.dart
│       └── utils/
│           ├── date_utils.dart
│           └── format_utils.dart


# ============================================================
## ANDROID CONFIG REQUIREMENTS
# ============================================================

## android/app/build.gradle
minSdkVersion = 26          # Android 8.0 (covers 95%+ Indian users)
targetSdkVersion = 34
compileSdkVersion = 34


## android/app/src/main/AndroidManifest.xml — Required permissions:
# <uses-permission android:name="android.permission.INTERNET"/>
# <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"/>
# <uses-permission android:name="android.permission.VIBRATE"/>
# <uses-permission android:name="android.permission.POST_NOTIFICATIONS"/>
# <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"
#     android:maxSdkVersion="28"/>
# <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"
#     android:maxSdkVersion="32"/>


# ============================================================
## FIREBASE SETUP (Run once after cloning)
# ============================================================

# 1. Install FlutterFire CLI:
#    dart pub global activate flutterfire_cli

# 2. Configure Firebase:
#    flutterfire configure
#    → Select project: rozgarx-ai
#    → Platforms: android
#    → This generates lib/core/firebase/firebase_options.dart

# 3. Download google-services.json:
#    Place in: android/app/google-services.json


# ============================================================
## FIRESTORE OFFLINE PERSISTENCE SETUP
# ============================================================

# In lib/core/firebase/firestore_service.dart:
#
# FirebaseFirestore.instance.settings = const Settings(
#   persistenceEnabled: true,             # Offline reads enabled
#   cacheSizeBytes: Settings.CACHE_SIZE_UNLIMITED,
# );
#
# This MUST be called before any Firestore reads.
# Call it in main.dart before runApp().


# ============================================================
## LOW-END DEVICE OPTIMIZATION CHECKLIST
# ============================================================

## ✅ Done in generated code:
# - Shimmer loading (no blank screens)
# - Static bars instead of animated on low-end
# - No shadow rendering on low-end cards
# - Bandwidth detected once, stored in Hive
# - Device category from SDK version

## Must implement in remaining screens:
# - Disable Lottie animations on low-end (use static icon instead)
# - Use static chart (simple bar widget) instead of fl_chart on low-end
# - Limit visible list items: 15 max per page (pagination)
# - Use SliverList with RepaintBoundary on all job lists
# - Avoid Hero animations on low-end devices


# ============================================================
## OFFLINE MODE FLOW
# ============================================================

# App Launch:
#   1. Show splash screen
#   2. Check Hive for cached jobs
#   3. If cached → show immediately (< 100ms)
#   4. In background → attempt Firestore fetch
#   5. If fetch succeeds → update UI
#   6. If fetch fails → show offline banner

# Offline Banner behavior:
#   - Show non-intrusive banner at top: "Offline — showing saved data"
#   - Auto-dismiss when connection restores
#   - Retry button to force refresh

# Saved jobs:
#   - Always available offline
#   - Sync queue fires when connection restores
#   - Show pending sync count in profile tab


# ============================================================
## PDF VIEWER DECISIONS
# ============================================================

# Package: syncfusion_flutter_pdfviewer
# License: Free for community use (< $1M revenue)
# Above $1M: requires paid license (~$595/developer/year)

# Alternatives if license cost becomes issue:
#   - flutter_pdfview (open source, fewer features)
#   - native_pdf_view (good quality, free)

# PDF Cache strategy:
#   - Max 20 PDFs stored locally (50MB limit)
#   - LRU eviction (oldest removed first)
#   - Cache valid for 7 days
#   - User can manually download to Downloads folder


# ============================================================
## PERFORMANCE TARGETS
# ============================================================

# App cold start:        < 2 seconds (target 1.5s)
# Job list load (cache): < 200ms
# Job list load (fresh): < 1.5 seconds
# Job card render:       < 16ms (60fps)
# PDF open (cached):     < 500ms
# PDF open (fresh):      depends on file size

# Memory targets:
#   Low-end device (2GB RAM):  < 150MB heap
#   Mid-range (4GB RAM):       < 250MB heap

# Bundle size target:
#   APK:    < 25MB
#   AAB:    < 20MB
# Use flutter build apk --split-per-abi for smaller downloads


# ============================================================
## SECURITY CHECKLIST
# ============================================================

# [ ] Enable ProGuard/R8 in release build
# [ ] Obfuscate with --obfuscate flag
# [ ] No API keys in source code (use .env or Firebase Remote Config)
# [ ] Certificate pinning for Firebase (optional but recommended)
# [ ] Disable debug logs in release build
# [ ] flutter build apk --release --obfuscate --split-debug-info=build/symbols
# [ ] Rooted device detection (optional for premium content protection)


# ============================================================
## BUILD COMMANDS
# ============================================================

# Debug:
flutter run

# Release APK (split by ABI — smaller download for users):
flutter build apk --release --split-per-abi --obfuscate --split-debug-info=build/symbols

# Release AAB (for Play Store):
flutter build appbundle --release --obfuscate --split-debug-info=build/symbols

# Run tests:
flutter test

# Analyze:
flutter analyze
